/* $Id: unb_lib.min.js 6 2015-07-08 07:07:06Z PragmaMx $ */
var openerdoc=null;function UnbTextKeydownHandler(where){if(!window.event){return true;}var keycode=window.event.keyCode;if(keycode==9){if(document.selection.createRange().duplicate().text.length){if(!window.event.shiftKey){document.selection.createRange().duplicate().text="\t"+document.selection.createRange().duplicate().text.replace(/\n/g,"\n\t")+"\n";}else{document.selection.createRange().duplicate().text=document.selection.createRange().duplicate().text.replace(/\n\t/g,"\n");document.selection.createRange().duplicate().text=document.selection.createRange().duplicate().text.replace(/^\t/g,"")+"\n";}}else{if(!window.event.shiftKey){UnbInsertText("\t");}}return false;}}function UnbEditorDoCmd(event,cmd,arg1){textbox.focus();switch(cmd){case"bold":UnbEncloseText("[b]","[/b]",1);break;case"italic":UnbEncloseText("[i]","[/i]",1);break;case"underline":UnbEncloseText("[u]","[/u]",1);break;case"center":UnbEncloseText("[center]","[/center]",1);break;case"line":UnbInsertText("[line]");break;case"list":UnbEncloseText("[list][*]"," [/list]",1);break;case"list_1":UnbEncloseText("[list=1][*]"," [/list=1]",1);break;case"list_A":UnbEncloseText("[list=A][*]"," [/list=A]",1);break;case"email":UnbEncloseText("[email]","[/email]",1);break;case"quote":if(event.shiftKey){UnbInsertText("[/quote]\n\n\n\n[quote]\n");if(textbox.selectionStart>=0){textbox.selectionStart=textbox.selectionEnd-=10;}}else{UnbEncloseText("[quote]\n","\n[/quote]",1);}break;case"code":if(event.shiftKey){UnbInsertText("[/code]\n\n\n\n[code]\n");if(textbox.selectionStart>=0){textbox.selectionStart=textbox.selectionEnd-=10;}}else{UnbEncloseText("[code]\n","\n[/code]",1);}break;case"php":if(event.shiftKey){UnbInsertText("[/php]\n\n\n\n[php]\n");if(textbox.selectionStart>=0){textbox.selectionStart=textbox.selectionEnd-=10;}}else{UnbEncloseText("[php]\n","\n[/php]",1);}break;case"url":if(event.shiftKey){UnbEncloseText("[url=]","[/url]",0);if(textbox.selectionStart>=0){textbox.selectionStart=textbox.selectionEnd=textbox.selectionStart+5;}}else{UnbEncloseText("[url]","[/url]",1);}break;case"img":UnbEncloseText("[img]","[/img]",1);break;case"color":UnbEncloseText("[color="+arg1+"]","[/color]",1);break;case"font":UnbEncloseText("[font="+arg1+"]","[/font]",1);break;case"size":UnbEncloseText("[size="+arg1+"]","[/size]",1);break;}}function UnbEncloseText(t_open,t_close,cursorpos){var is_ie=(navigator.appName=="Microsoft Internet Explorer");if(is_ie&&document.selection&&document.selection.createRange().duplicate().text.length){var seltext=document.selection.createRange().duplicate().text;if(seltext.substring(0,t_open.length)==t_open&&seltext.substring(seltext.length-t_close.length,seltext.length)==t_close){document.selection.createRange().duplicate().text=seltext.substring(t_open.length,seltext.length-t_close.length);}else{document.selection.createRange().duplicate().text=t_open+seltext+t_close;}}else{if(textbox.selectionEnd&&(textbox.selectionEnd-textbox.selectionStart>0)){var start_selection=textbox.selectionStart;var end_selection=textbox.selectionEnd;var new_endsel;var scroll_top=textbox.scrollTop;var scroll_left=textbox.scrollLeft;var start=textbox.value.substring(0,start_selection);var seltext=textbox.value.substring(start_selection,end_selection);var end=textbox.value.substring(end_selection,textbox.textLength);if(seltext.substring(0,t_open.length)==t_open&&seltext.substring(seltext.length-t_close.length,seltext.length)==t_close){seltext=seltext.substring(t_open.length,seltext.length-t_close.length);new_endsel=end_selection-t_open.length-t_close.length;}else{seltext=t_open+seltext+t_close;new_endsel=end_selection+t_open.length+t_close.length;}textbox.value=start+seltext+end;textbox.selectionStart=start_selection;textbox.selectionEnd=new_endsel;textbox.scrollTop=scroll_top;textbox.scrollLeft=scroll_left;}else{UnbInsertText(t_open+t_close);if(cursorpos<=1){textbox.selectionEnd-=t_close.length;}if(cursorpos<=0){textbox.selectionEnd-=t_open.length;}}}}function UnbInsertText(what,replace){if(replace==null){replace=0;}if(openerdoc){curdoc=openerdoc;}else{curdoc=document;}if(textbox.createTextRange){textbox.focus();curdoc.selection.createRange().duplicate().text=what;textbox.focus();}else{if(textbox.selectionStart>=0){var start_selection=textbox.selectionStart;var end_selection=textbox.selectionEnd;var scroll_top=textbox.scrollTop;var scroll_left=textbox.scrollLeft;var start=textbox.value.substring(0,start_selection-replace);var end=textbox.value.substring(end_selection,textbox.textLength);textbox.value=start+what+end;textbox.selectionStart=textbox.selectionEnd=start_selection-replace+what.length;textbox.focus();textbox.scrollTop=scroll_top;textbox.scrollLeft=scroll_left;}else{textbox.value+=what;textbox.focus();}}if(openerdoc){window.focus();}}